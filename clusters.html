<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>RGM - tiny react google map library</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="next-head-count" content="3"/><link rel="preload" href="/rgm/_next/static/0ltODh2t6la7EpPzfTwqQ/pages/_app.js" as="script"/><link rel="preload" href="/rgm/_next/static/0ltODh2t6la7EpPzfTwqQ/pages/clusters.js" as="script"/><link rel="preload" href="/rgm/_next/static/runtime/webpack-1c5199ff66550d26e499.js" as="script"/><link rel="preload" href="/rgm/_next/static/chunks/framework.e84fa698c7ee940652bd.js" as="script"/><link rel="preload" href="/rgm/_next/static/chunks/13cbfce1.9c3965372dce5ef7c77e.js" as="script"/><link rel="preload" href="/rgm/_next/static/chunks/commons.51a222874f57d1c3e4a9.js" as="script"/><link rel="preload" href="/rgm/_next/static/chunks/c1a69c9d71809a24512853133d6615d88c848ee2.f486bf62241ddac94c93.js" as="script"/><link rel="preload" href="/rgm/_next/static/runtime/main-930559fd51454aac4b45.js" as="script"/></head><body><div id="__next"><style data-emotion-css="a0dvwg">:root{--primary-color:#333;--secondary-color:#666;--layout-border:1px solid var(--primary-color);--font-size:16px;}@media only screen and (max-width:640px){:root{--none-on-mobile:none;--font-size:14px;}}body,html{margin:0;height:100%;color:var(--primary-color);font-size:var(--font-size);}html{-webkit-font-smoothing:antialiased;box-sizing:border-box;}html{overflow-y:scroll;}.gm-style{font:unset;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;}*,*:before,*:after{box-sizing:inherit;min-width:0;}#__next{min-height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}body{margin:0;}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block;}audio,canvas,progress,video{display:inline-block;}audio:not([controls]){display:none;height:0;}progress{vertical-align:baseline;}[hidden],template{display:none;}a{background-color:transparent;-webkit-text-decoration-skip:objects;}a:active,a:hover{outline-width:0;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:inherit;font-weight:bolder;}dfn{font-style:italic;}h1{font-size:2em;margin:.67em 0;}mark{background-color:#ff0;color:#000;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-.25em;}sup{top:-.5em;}img{border-style:none;}svg:not(:root){overflow:hidden;}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em;}figure{margin:1em 40px;}hr{box-sizing:content-box;height:0;overflow:visible;}button,input,optgroup,select,textarea{font:inherit;margin:0;}optgroup{font-weight:700;}button,input{overflow:visible;}button,select{text-transform:none;}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button;}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0;}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText;}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}textarea{overflow:auto;}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0;}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto;}[type=search]{-webkit-appearance:textfield;outline-offset:-2px;}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-input-placeholder{color:inherit;opacity:.54;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}html{font:100%/1.45 'georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'georgia',serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}ul{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:0.85rem;line-height:1.45rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}blockquote{margin-left:1.45rem;margin-right:1.45rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.45rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.45rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}li > ul{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.45rem / 2);}code{font-size:0.85rem;line-height:1.45rem;}kbd{font-size:0.85rem;line-height:1.45rem;}samp{font-size:0.85rem;line-height:1.45rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;-webkit-text-decoration:none;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:0.96667rem;padding-right:0.96667rem;padding-top:0.725rem;padding-bottom:calc(0.725rem - 1px);}th:first-of-type,td:first-of-type{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:unset;}blockquote{margin:0 auto;padding:0.1rem 1rem;border-left:5px solid #eee;}blockquote:before{display:none;}blockquote:not(:first-of-type){margin-top:0.75em;}</style><style data-emotion-css="15cm7vf">.css-15cm7vf{width:100%;max-width:1024px;margin:0 auto;display:grid;grid-gap:2px;grid-template-rows:auto 1fr;grid-template-areas:"head head" "main nav" "pad pad";grid-template-columns:1fr minmax(240px,auto);grid-template-rows:auto 1fr auto;}@media only screen and (max-width:640px){.css-15cm7vf{grid-template-areas:"head" "main" "nav" "pad";grid-template-rows:auto 1fr auto auto;grid-template-columns:1fr;}}</style><div class="css-15cm7vf"><style data-emotion-css="de2xit">.css-de2xit{border-bottom:var(--layout-border);grid-area:head;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:20px 0px 12px 0px;}@media only screen and (max-width:1048px){.css-de2xit{padding:16px 8px 12px 8px;}}@media only screen and (max-width:640px){.css-de2xit{padding:12px 8px 8px 8px;}}</style><header class="css-de2xit"><style data-emotion-css="1rap1x3">.css-1rap1x3{margin-right:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:baseline;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;}</style><div class="css-1rap1x3"><style data-emotion-css="gx0lhm">.css-gx0lhm{margin-bottom:0;}</style><h1 class="css-gx0lhm">RGM</h1><style data-emotion-css="5toduw">.css-5toduw{padding-left:4px;font-size:0.75rem;}</style><div class="css-5toduw">react google map</div></div><a href="https://github.com/realadvisor/rgm"><style data-emotion-css="kqzqgg">.css-kqzqgg{fill:currentColor;}</style><svg width="32" height="32" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="css-kqzqgg"><title>GitHub icon</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></header><style data-emotion-css="2b6onv">.css-2b6onv{grid-area:main;padding:16px;border:var(--layout-border);border-left:none;border-right:var(--none-on-mobile,var(--layout-border));}</style><main class="css-2b6onv"><style data-emotion-css="1uhyy0y">.css-1uhyy0y{display:grid;grid-gap:24px;}.css-1uhyy0y > div:not(:first-of-type),.css-1uhyy0y > pre{box-shadow:0 0 0 2px white,0 0 0 3px var(--secondary-color),0 0 0 5px white,0 0 0 6px var(--secondary-color);}</style><div class="css-1uhyy0y"><style data-emotion-css="l4hjtd">.css-l4hjtd h1{font-size:1.5rem;}</style><div class="css-l4hjtd"> <!-- {"order": 7} -->
<h1>Clusters example</h1>
<p>Real life example. <em>(clusters, zoom on marker click)</em></p>
</div><style data-emotion-css="2128tu">.css-2128tu{position:relative;width:100%;padding-top:75%;}.css-2128tu > *{position:absolute;left:0;top:0;}</style><div class="css-2128tu"></div><style data-emotion-css="4bgcc3">.css-4bgcc3 pre[class*='language-'],.css-4bgcc3 code[class*='language-']{color:#d4d4d4;font-size:0.8rem;text-shadow:none;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-4bgcc3 pre[class*='language-']::selection,.css-4bgcc3 code[class*='language-']::selection{text-shadow:none;background:#b3d4fc;}@media print{.css-4bgcc3 pre[class*='language-'],.css-4bgcc3 code[class*='language-']{text-shadow:none;}}.css-4bgcc3 pre[class*='language-']{padding:1em;margin:0;overflow:auto;background:#1e1e1e;}.css-4bgcc3:not(pre) > code[class*='language-']{padding:0.1em 0.3em;border-radius:0.3em;color:#db4c69;background:#f9f2f4;}.css-4bgcc3 .namespace{opacity:0.7;}.css-4bgcc3 .token.comment,.css-4bgcc3 .token.prolog,.css-4bgcc3 .token.doctype,.css-4bgcc3 .token.cdata{color:#6a9955;}.css-4bgcc3 .token.punctuation{color:#d4d4d4;}.css-4bgcc3 .token.property,.css-4bgcc3 .token.tag,.css-4bgcc3 .token.boolean,.css-4bgcc3 .token.number,.css-4bgcc3 .token.constant,.css-4bgcc3 .token.symbol,.css-4bgcc3 .token.deleted{color:#b5cea8;}.css-4bgcc3 .token.selector,.css-4bgcc3 .token.attr-name,.css-4bgcc3 .token.string,.css-4bgcc3 .token.char,.css-4bgcc3 .token.builtin,.css-4bgcc3 .token.inserted{color:#7dd823;}.css-4bgcc3 .token.operator,.css-4bgcc3 .token.entity,.css-4bgcc3 .token.url,.css-4bgcc3 .language-css .token.string,.css-4bgcc3 .style .token.string{color:#d4d4d4;background:#1e1e1e;}.css-4bgcc3 .token.atrule,.css-4bgcc3 .token.attr-value,.css-4bgcc3 .token.keyword{color:#ff4d00;}.css-4bgcc3 .token.function{color:#ffe33d;}.css-4bgcc3 .token.regex,.css-4bgcc3 .token.important,.css-4bgcc3 .token.variable{color:#d16969;}.css-4bgcc3 .token.important,.css-4bgcc3 .token.bold{font-weight:bold;}.css-4bgcc3 .token.italic{font-style:italic;}.css-4bgcc3 .token.constant{color:#9cdcfe;}.css-4bgcc3 .token.class-name{color:#4ec9b0;}.css-4bgcc3 .token.parameter{color:#9cdcfe;}.css-4bgcc3 .token.interpolation{color:#9cdcfe;}.css-4bgcc3 .token.punctuation.interpolation-punctuation{color:#569cd6;}.css-4bgcc3 .token.boolean{color:#569cd6;}.css-4bgcc3 .token.property{color:#9cdcfe;}.css-4bgcc3 .token.selector{color:#d7ba7d;}.css-4bgcc3 .token.tag{color:#ff5bd7;}.css-4bgcc3 .token.attr-name{color:#9cdcfe;}.css-4bgcc3 .token.attr-value{color:#ce9178;}.css-4bgcc3 .token.entity{color:#4ec9b0;cursor:unset;}.css-4bgcc3 .token.namespace{color:#4ec9b0;}.css-4bgcc3 .token-line{min-height:12px;}.css-4bgcc3 pre[class*='language-javascript'],.css-4bgcc3 code[class*='language-javascript']{color:#4ec9b0;}.css-4bgcc3 pre[class*='language-css'],.css-4bgcc3 code[class*='language-css']{color:#ce9178;}.css-4bgcc3 pre[class*='language-html'],.css-4bgcc3 code[class*='language-html']{color:#d4d4d4;}.css-4bgcc3 .language-html .token.punctuation{color:#808080;}.css-4bgcc3 pre[data-line]{position:relative;}.css-4bgcc3 pre[class*='language-'] > code[class*='language-']{position:relative;z-index:1;}.css-4bgcc3 .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:#f7ebc6;box-shadow:inset 5px 0 0 #f7d87c;z-index:0;pointer-events:none;line-height:inherit;white-space:pre;}</style><div class="css-4bgcc3"><pre class="prism-code language-jsx"><div class="token-line"><span class="token comment">// @flow</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword">as</span><span class="token plain"> React </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> Map</span><span class="token punctuation">,</span><span class="token plain"> Overlay</span><span class="token punctuation">,</span><span class="token plain"> Marker </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;rgm&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> css </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;@emotion/core&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// $FlowFixMe</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> Supercluster </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;supercluster&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> useGoogleApiLoader </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;../dev-src/hooks&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> Ratio </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;../dev-src/controls&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> getScreenOffset </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;../dev-src/geo-utils&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// $FlowFixMe</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> places </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;../data/places.json&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> superclusterIndex </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Supercluster</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  log</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  radius</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">60</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  extent</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">256</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  maxZoom</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">17</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token plain">places</span><span class="token punctuation">.</span><span class="token plain">features</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token constant">MAP_OPTIONS</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  zoom</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  maxZoom</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">17</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  center</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    lat</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    lng</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">30.304</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// disable cmd-zoom and 2 fingers zoom I personally dislike it</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  gestureHandling</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;greedy&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  clickableIcons</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">type Cluster </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  geometry</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    coordinates</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">number</span><span class="token punctuation">,</span><span class="token plain"> number</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  id</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> number</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    cluster</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> boolean</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    cluster_id</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> number</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    point_count</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> number</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// Google has no &quot;zoom at point&quot; method</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">zoomAt</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">map</span><span class="token parameter punctuation">,</span><span class="token parameter"> pt</span><span class="token parameter punctuation">,</span><span class="token parameter"> zoom</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> center </span><span class="token operator">=</span><span class="token plain"> map</span><span class="token punctuation">.</span><span class="token function">getCenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> centerLatLng </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    lat</span><span class="token operator">:</span><span class="token plain"> center</span><span class="token punctuation">.</span><span class="token function">lat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    lng</span><span class="token operator">:</span><span class="token plain"> center</span><span class="token punctuation">.</span><span class="token function">lng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> offsetA </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">getScreenOffset</span><span class="token punctuation">(</span><span class="token plain">pt</span><span class="token punctuation">,</span><span class="token plain"> centerLatLng</span><span class="token punctuation">,</span><span class="token plain"> map</span><span class="token punctuation">.</span><span class="token function">getZoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> offsetB </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">getScreenOffset</span><span class="token punctuation">(</span><span class="token plain">pt</span><span class="token punctuation">,</span><span class="token plain"> centerLatLng</span><span class="token punctuation">,</span><span class="token plain"> zoom</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> x </span><span class="token operator">=</span><span class="token plain"> offsetA</span><span class="token punctuation">.</span><span class="token plain">x </span><span class="token operator">-</span><span class="token plain"> offsetB</span><span class="token punctuation">.</span><span class="token plain">x</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> y </span><span class="token operator">=</span><span class="token plain"> offsetA</span><span class="token punctuation">.</span><span class="token plain">y </span><span class="token operator">-</span><span class="token plain"> offsetB</span><span class="token punctuation">.</span><span class="token plain">y</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  map</span><span class="token punctuation">.</span><span class="token function">setZoom</span><span class="token punctuation">(</span><span class="token plain">zoom</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  map</span><span class="token punctuation">.</span><span class="token function">panBy</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token punctuation">,</span><span class="token plain"> y</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">Clusters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> api </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">useGoogleApiLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">map</span><span class="token punctuation">,</span><span class="token plain"> setMap</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> React</span><span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">clusters</span><span class="token punctuation">,</span><span class="token plain"> setClusters</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> React</span><span class="token punctuation">.</span><span class="token plain">useState</span><span class="token operator">&lt;</span><span class="token plain">$ReadOnlyArray</span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Cluster</span><span class="token tag punctuation">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  React</span><span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">map </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">const</span><span class="token plain"> boundsChangedListener </span><span class="token operator">=</span><span class="token plain"> map</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">&#x27;idle&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">const</span><span class="token plain"> bounds </span><span class="token operator">=</span><span class="token plain"> map</span><span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">const</span><span class="token plain"> zoom </span><span class="token operator">=</span><span class="token plain"> map</span><span class="token punctuation">.</span><span class="token function">getZoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">const</span><span class="token plain"> sw </span><span class="token operator">=</span><span class="token plain"> bounds</span><span class="token punctuation">.</span><span class="token function">getSouthWest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">const</span><span class="token plain"> ne </span><span class="token operator">=</span><span class="token plain"> bounds</span><span class="token punctuation">.</span><span class="token function">getNorthEast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">const</span><span class="token plain"> swA </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">sw</span><span class="token punctuation">.</span><span class="token function">lng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> sw</span><span class="token punctuation">.</span><span class="token function">lat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">const</span><span class="token plain"> neA </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">ne</span><span class="token punctuation">.</span><span class="token function">lng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> ne</span><span class="token punctuation">.</span><span class="token function">lat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// Supercluster don&#x27;t work in some cases, fix it</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">swA</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> neA</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> swA</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">-</span><span class="token plain"> neA</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">0.00001</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          swA</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          neA</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">180</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">const</span><span class="token plain"> clusters </span><span class="token operator">=</span><span class="token plain"> superclusterIndex</span><span class="token punctuation">.</span><span class="token function">getClusters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span><span class="token plain">swA</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token operator">...</span><span class="token plain">neA</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> zoom</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token function">setClusters</span><span class="token punctuation">(</span><span class="token plain">clusters</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        boundsChangedListener</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">map</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Ratio</span><span class="token tag"> </span><span class="token tag attr-name">value</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript number">3</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript operator">/</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript number">4</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain">api </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Map</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">setMap</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">api</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">api</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">options</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript constant">MAP_OPTIONS</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Overlay</span><span class="token tag"> </span><span class="token tag attr-name">debug</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript boolean">false</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">{</span><span class="token plain">clusters</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cluster</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">lng</span><span class="token punctuation">,</span><span class="token plain"> lat</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> cluster</span><span class="token punctuation">.</span><span class="token plain">geometry</span><span class="token punctuation">.</span><span class="token plain">coordinates</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Marker</span><span class="token tag"> </span><span class="token tag attr-name">key</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">lng</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string string"> - </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">lat</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">lng</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">lng</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">lat</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">lat</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  </span><span class="token operator">&lt;</span><span class="token plain">ClusterMarker</span></div><div class="token-line"><span class="token plain">                    count</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token plain">cluster</span><span class="token punctuation">.</span><span class="token plain">properties</span><span class="token punctuation">.</span><span class="token plain">point_count </span><span class="token operator">??</span><span class="token plain"> </span><span class="token keyword">null</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                    onClick</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                      </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">map </span><span class="token operator">&amp;&amp;</span><span class="token plain"> cluster</span><span class="token punctuation">.</span><span class="token plain">id </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                        </span><span class="token function">zoomAt</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                          map</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                          </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                            lng</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                            lat</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                          </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                          superclusterIndex</span><span class="token punctuation">.</span><span class="token function">getClusterExpansionZoom</span><span class="token punctuation">(</span><span class="token plain">cluster</span><span class="token punctuation">.</span><span class="token plain">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                        </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                      </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                    </span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token tag punctuation">&lt;/</span><span class="token tag class-name">Marker</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token tag punctuation">&lt;/</span><span class="token tag class-name">Overlay</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token tag punctuation">&lt;/</span><span class="token tag class-name">Map</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag class-name">Ratio</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// css is awesome!</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">ClusterMarker</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter punctuation">{</span><span class="token parameter"> count</span><span class="token parameter punctuation">,</span><span class="token parameter"> onClick </span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> text </span><span class="token operator">=</span><span class="token plain"> count </span><span class="token operator">??</span><span class="token plain"> </span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">      </span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">onClick</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">      </span><span class="token tag attr-name">css</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">css</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string"></span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        position: relative;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        place-self: center center;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        border-radius: 100%;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        border: 3px solid #eee;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        background-color: white;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        padding: </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">count </span><span class="token tag script language-javascript template-string interpolation operator">==</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation keyword">null</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation number">2</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation number">8</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string string">px;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        box-shadow: 0 0 0 2px #fe4a0d, 0 0 0 4px white;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        &amp;:after {</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          padding-top: 100%;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          content: &#x27; &#x27;;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          display: block;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        }</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        font-size: 1rem;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string"></span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        &amp;:hover {</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          padding: </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">${</span><span class="token tag script language-javascript template-string interpolation">count </span><span class="token tag script language-javascript template-string interpolation operator">==</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation keyword">null</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation operator">?</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation number">3</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation operator">:</span><span class="token tag script language-javascript template-string interpolation"> </span><span class="token tag script language-javascript template-string interpolation number">10</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation">}</span><span class="token tag script language-javascript template-string string">px;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          transition: padding 0.07s ease-out;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          z-index: 1;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        }</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        transition: padding 0.07s ease-in;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        cursor: pointer;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">      </span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">    </span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">        </span><span class="token tag attr-name">css</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">css</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string"></span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          height: 0;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          overflow: hidden;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        </span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">      </span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain">text</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">        </span><span class="token tag attr-name">css</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">css</span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript template-string string"></span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          position: absolute;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          left: 0;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          top: 0;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          width: 100%;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          height: 100%;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          display: flex;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          align-items: center;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">          justify-content: center;</span></div><div class="token-line"><span class="token tag script language-javascript template-string string">        </span><span class="token tag script language-javascript template-string template-punctuation string">`</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">      </span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain">text</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></div></main><style data-emotion-css="wz4heq">.css-wz4heq{padding:16px;border:var(--layout-border);border-right:none;border-left:var(--none-on-mobile,var(--layout-border));padding-bottom:48px;}</style><nav class="css-wz4heq"><style data-emotion-css="1r0ytul">.css-1r0ytul{box-sizing:border-box;min-width:0;min-height:0;margin-bottom:0.75rem;}</style><h3 class="css-1r0ytul">Examples</h3><style data-emotion-css="1qqto5f">.css-1qqto5f{line-height:1.6rem;}</style><div class="css-1qqto5f"><style data-emotion-css="gyp8mm">.css-gyp8mm{visibility:hidden;}</style><span class="css-gyp8mm">❯</span> <a href="/rgm/" class="css-0">RGM - React Google Map</a></div><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/google-marker" class="css-0">Native google marker</a></div><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/geojson" class="css-0">Show geojson</a></div><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/events" class="css-0">Events</a></div><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/imperative" class="css-0">Google map methods</a></div><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/react-markers" class="css-0">React markers</a></div><div class="css-1qqto5f"><style data-emotion-css="rrm59m">.css-rrm59m{visibility:visible;}</style><span class="css-rrm59m">❯</span> <style data-emotion-css="1ydg16i">.css-1ydg16i{color:#000;-webkit-text-decoration:none;text-decoration:none;}</style><a href="/rgm/clusters" class="css-1ydg16i">Clusters example</a></div><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/performance" class="css-0">N markers</a></div><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/ts-example" class="css-0">Typescript</a></div><style data-emotion-css="10euwdh">.css-10euwdh{box-sizing:border-box;min-width:0;min-height:0;margin-top:2rem;margin-bottom:0.75rem;}</style><h3 class="css-10euwdh">Tests</h3><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/vis-test-n-uniq" class="css-0">N markers (uniq key)</a></div><div class="css-1qqto5f"><span class="css-gyp8mm">❯</span> <a href="/rgm/vis-test-n-index" class="css-0">N markers (key as index)</a></div></nav><style data-emotion-css="cbd8v0">.css-cbd8v0{grid-area:pad;border-top:var(--layout-border);text-align:right;padding:4px;font-size:0.5rem;}</style><div class="css-cbd8v0">EXAMPLES ARE PROVIDED UNDER THE<!-- --> <a href="https://en.wikipedia.org/wiki/Beerware">BEER-WARE</a> LICENSE</div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"pageDocs":[{"title":"RGM - React Google Map","order":1,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map, Overlay, Marker, useMap } from 'rgm';\nimport { css } from '@emotion/core';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n  gestureHandling: 'greedy',\n  clickableIcons: false,\n};\n\nexport default function Rgm() {\n  const api = useGoogleApiLoader();\n\n  return (\n    \u003cRatio value={3 / 4}\u003e\n      {api \u0026\u0026 (\n        \u003cMap api={api} options={MAP_OPTIONS}\u003e\n          \u003cOverlay\u003e\n            \u003cMarker lat={MAP_OPTIONS.center.lat} lng={MAP_OPTIONS.center.lng}\u003e\n              \u003cCircleMarker /\u003e\n            \u003c/Marker\u003e\n          \u003c/Overlay\u003e\n          \u003cChild /\u003e\n        \u003c/Map\u003e\n      )}\n    \u003c/Ratio\u003e\n  );\n}\n\nconst Child = () =\u003e {\n  const { api, map } = useMap();\n\n  React.useEffect(() =\u003e {\n    console.info(map.getCenter().toJSON(), api.version);\n  }, [map, api]);\n\n  return null;\n};\n\nconst CircleMarker = () =\u003e (\n  \u003cdiv\n    css={css`\n      place-self: center center;\n      width: 50px;\n      height: 50px;\n      border-radius: 100%;\n      background-color: white;\n      border: 3px solid red;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    `}\n  \u003e\n    RGM\n  \u003c/div\u003e\n);\n\n","pathname":"/","markdown":" \u003c!-- {\"order\": 1} --\u003e\n\u003ch1\u003eRGM - React Google Map\u003c/h1\u003e\n\u003cp\u003eTiny but very powerful React Google Map.\nIt allows you to render any React component on the Google Map,\nand provides easy access to native google map api.\u003c/p\u003e\n\u003cp\u003eMinimal example with all existing api usage \u003cem\u003e(without Overlay debug prop)\u003c/em\u003e.\u003c/p\u003e\n"},{"title":"Native google marker","order":2,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map, useMap } from 'rgm';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n};\n\ntype MarkerProps = {|\n  lat: number,\n  lng: number,\n|};\n\nexport const GoogleMarker = ({ lat, lng }: MarkerProps) =\u003e {\n  const { api, map } = useMap();\n\n  React.useEffect(() =\u003e {\n    if (api) {\n      const marker = new api.Marker({\n        map,\n        position: {\n          lat,\n          lng,\n        },\n      });\n\n      return () =\u003e {\n        marker.setMap(null);\n      };\n    }\n  }, [api, map, lat, lng]);\n\n  return null;\n};\n\nexport default function GoogleMarkerPage() {\n  const api = useGoogleApiLoader();\n\n  return (\n    \u003cRatio value={3 / 4}\u003e\n      {api \u0026\u0026 (\n        \u003cMap api={api} options={MAP_OPTIONS}\u003e\n          \u003cGoogleMarker\n            lat={MAP_OPTIONS.center.lat}\n            lng={MAP_OPTIONS.center.lng}\n          /\u003e\n        \u003c/Map\u003e\n      )}\n    \u003c/Ratio\u003e\n  );\n}\n\n","pathname":"/google-marker","markdown":" \u003c!-- {\"order\": 2} --\u003e\n\u003ch1\u003eNative google marker\u003c/h1\u003e\n\u003cp\u003eGet instances of \u003ca href=\"https://developers.google.com/maps/documentation/javascript/reference/map\"\u003egoogle.maps.Map\u003c/a\u003e\nclass and instance of \u003cem\u003egoogle.maps\u003c/em\u003e using \u003cem\u003euseMap\u003c/em\u003e hook.\u003c/p\u003e\n\u003cp\u003eThen as like as in \u003ca href=\"https://developers.google.com/maps/documentation/javascript/adding-a-google-map\"\u003eexample here\u003c/a\u003e\njust add marker using \u003cem\u003eReact.useEffect\u003c/em\u003e hook\u003c/p\u003e\n\u003cp\u003eYou can ask why not to expose it with the library.\nSee the \u003ca href=\"https://developers.google.com/maps/documentation/javascript/reference/marker#Marker\"\u003eapi surface of Google marker\u003c/a\u003e\nThe final component may be huge and not solve all the cases.\u003c/p\u003e\n"},{"title":"Show geojson","order":3,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map, useMap } from 'rgm';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 13,\n  center: {\n    lat: 46.22212,\n    lng: 6.14156,\n  },\n  // disable cmd-zoom and 2 fingers zoom I personally dislike it\n  gestureHandling: 'greedy',\n  clickableIcons: false,\n};\n\nconst BG_STYLE = {\n  fillColor: 'transparent',\n  strokeColor: 'white',\n  strokeWeight: 6,\n  strokeOpacity: 1,\n  cursor: 'hand',\n};\n\nconst FG_STYLE = {\n  fillColor: 'transparent',\n  strokeColor: 'blue',\n  strokeWeight: 2,\n  strokeOpacity: 1,\n  cursor: 'hand',\n};\n\n// https://developers.google.com/maps/documentation/javascript/datalayer\n// https://developers.google.com/maps/documentation/javascript/reference/data\nconst GeoJson = ({ children }) =\u003e {\n  const { map } = useMap();\n\n  React.useEffect(() =\u003e {\n    let style = BG_STYLE;\n    // To prevent style blink we override style inside addListener\n    const addFeatureListener = map.data.addListener('addfeature', event =\u003e {\n      map.data.overrideStyle(event.feature, style);\n    });\n\n    const features = [];\n    // Add background white shaped border for better visibility\n    features.push(...map.data.addGeoJson(children));\n\n    // Add foreground  thinner border with primary color\n    style = FG_STYLE;\n    features.push(...map.data.addGeoJson(children));\n\n    addFeatureListener.remove();\n\n    return () =\u003e {\n      features.forEach(feature =\u003e map.data.remove(feature));\n    };\n  }, [map, children]);\n\n  return null;\n};\n\nexport default function GeoJSONPage() {\n  const api = useGoogleApiLoader();\n\n  return (\n    \u003cRatio value={3 / 4}\u003e\n      {api \u0026\u0026 (\n        \u003cMap api={api} options={MAP_OPTIONS}\u003e\n          \u003cGeoJson\u003e{geoJSON}\u003c/GeoJson\u003e\n        \u003c/Map\u003e\n      )}\n    \u003c/Ratio\u003e\n  );\n}\n\nconst geoJSON = {\n  type: 'Feature',\n  geometry: {\n    type: 'MultiPolygon',\n    coordinates: [\n      [\n        [\n          [6.166701, 46.224467],\n          [6.165925, 46.222455],\n          [6.1619, 46.215224],\n          [6.155766, 46.217359],\n          [6.151245, 46.216282],\n          [6.151087, 46.215332],\n          [6.150485, 46.215169],\n          [6.1509, 46.214227],\n          [6.150811, 46.214036],\n          [6.14938, 46.214312],\n          [6.149151, 46.214004],\n          [6.1494, 46.213891],\n          [6.148978, 46.213333],\n          [6.149199, 46.213245],\n          [6.149111, 46.213092],\n          [6.148458, 46.213299],\n          [6.148611, 46.213478],\n          [6.148046, 46.213725],\n          [6.14791, 46.213552],\n          [6.146289, 46.214207],\n          [6.146402, 46.214354],\n          [6.146021, 46.214516],\n          [6.145856, 46.214388],\n          [6.145229, 46.214795],\n          [6.145365, 46.214889],\n          [6.144523, 46.215537],\n          [6.140424, 46.215467],\n          [6.140431, 46.214992],\n          [6.140001, 46.214473],\n          [6.140495, 46.21431],\n          [6.140344, 46.213461],\n          [6.139154, 46.211822],\n          [6.138298, 46.212118],\n          [6.137611, 46.212103],\n          [6.137077, 46.212714],\n          [6.136788, 46.212579],\n          [6.136173, 46.21166],\n          [6.136793, 46.21125],\n          [6.136433, 46.210877],\n          [6.135918, 46.210767],\n          [6.136631, 46.210466],\n          [6.136455, 46.210278],\n          [6.135874, 46.210503],\n          [6.135143, 46.210281],\n          [6.135855, 46.209982],\n          [6.135933, 46.208969],\n          [6.135134, 46.20892],\n          [6.135138, 46.20837],\n          [6.1349, 46.208432],\n          [6.134884, 46.208718],\n          [6.133399, 46.209087],\n          [6.133291, 46.20889],\n          [6.132011, 46.209076],\n          [6.131403, 46.209387],\n          [6.131373, 46.209693],\n          [6.130356, 46.210561],\n          [6.129696, 46.210564],\n          [6.12969, 46.210818],\n          [6.129369, 46.21082],\n          [6.129375, 46.211045],\n          [6.129688, 46.211046],\n          [6.129688, 46.211504],\n          [6.12927, 46.211496],\n          [6.129271, 46.212405],\n          [6.129008, 46.212523],\n          [6.129764, 46.213246],\n          [6.129716, 46.213667],\n          [6.128841, 46.213665],\n          [6.127625, 46.214193],\n          [6.126112, 46.214342],\n          [6.125746, 46.214032],\n          [6.123964, 46.214867],\n          [6.124292, 46.215172],\n          [6.121739, 46.215671],\n          [6.119726, 46.216991],\n          [6.120624, 46.217769],\n          [6.122338, 46.216739],\n          [6.123393, 46.21744],\n          [6.124565, 46.217508],\n          [6.125727, 46.218289],\n          [6.126099, 46.218014],\n          [6.127509, 46.219169],\n          [6.128824, 46.220001],\n          [6.129532, 46.219521],\n          [6.129983, 46.219778],\n          [6.129575, 46.22013],\n          [6.130436, 46.220747],\n          [6.130256, 46.220853],\n          [6.130676, 46.221195],\n          [6.130523, 46.221425],\n          [6.130902, 46.221833],\n          [6.13211, 46.221023],\n          [6.13235, 46.221201],\n          [6.132201, 46.221296],\n          [6.133093, 46.221871],\n          [6.132963, 46.221989],\n          [6.133836, 46.222724],\n          [6.132913, 46.223371],\n          [6.133926, 46.224313],\n          [6.132755, 46.22515],\n          [6.131471, 46.22413],\n          [6.131008, 46.224101],\n          [6.129367, 46.225315],\n          [6.128872, 46.225032],\n          [6.127637, 46.22607],\n          [6.127951, 46.226179],\n          [6.128475, 46.225855],\n          [6.130178, 46.227029],\n          [6.12872, 46.228056],\n          [6.127686, 46.227353],\n          [6.126543, 46.22806],\n          [6.127468, 46.228897],\n          [6.127947, 46.2286],\n          [6.128718, 46.228867],\n          [6.131004, 46.230645],\n          [6.131211, 46.230302],\n          [6.132606, 46.230318],\n          [6.133546, 46.231009],\n          [6.133079, 46.231614],\n          [6.132808, 46.231513],\n          [6.132062, 46.232115],\n          [6.132336, 46.232319],\n          [6.131997, 46.232603],\n          [6.132238, 46.232774],\n          [6.131869, 46.233055],\n          [6.132281, 46.233307],\n          [6.132955, 46.23278],\n          [6.134405, 46.233909],\n          [6.135986, 46.234248],\n          [6.136307, 46.234193],\n          [6.137361, 46.233404],\n          [6.13613, 46.232762],\n          [6.136964, 46.231991],\n          [6.138166, 46.231296],\n          [6.135923, 46.230627],\n          [6.136604, 46.230069],\n          [6.13744, 46.228493],\n          [6.137943, 46.228181],\n          [6.139237, 46.228034],\n          [6.13947, 46.228662],\n          [6.138837, 46.228839],\n          [6.138821, 46.22961],\n          [6.138533, 46.230292],\n          [6.142864, 46.2293],\n          [6.143428, 46.230636],\n          [6.143698, 46.230099],\n          [6.145883, 46.228727],\n          [6.145576, 46.227293],\n          [6.146152, 46.226945],\n          [6.146293, 46.227101],\n          [6.146995, 46.226354],\n          [6.148206, 46.226053],\n          [6.148941, 46.227792],\n          [6.166701, 46.224467],\n        ],\n      ],\n    ],\n  },\n};\n\n","pathname":"/geojson","markdown":" \u003c!-- {\"order\": 3} --\u003e\n\u003ch1\u003eShow geojson\u003c/h1\u003e\n\u003cp\u003eGet instances of \u003ca href=\"https://developers.google.com/maps/documentation/javascript/reference/map\"\u003egoogle.maps.Map\u003c/a\u003e\nclass and instance of \u003cem\u003egoogle.maps\u003c/em\u003e using \u003cem\u003euseMap\u003c/em\u003e hook.\u003c/p\u003e\n\u003cp\u003eThen using \u003ca href=\"https://developers.google.com/maps/documentation/javascript/datalayer\"\u003egoogle api datalayer\u003c/a\u003e and\n\u003ca href=\"https://developers.google.com/maps/documentation/javascript/reference/data\"\u003eapi reference\u003c/a\u003e\njust add geojson using \u003cem\u003eReact.useEffect\u003c/em\u003e hook\u003c/p\u003e\n"},{"title":"Events","order":4,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map } from 'rgm';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio, Info } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n};\n\nexport default function Events() {\n  const api = useGoogleApiLoader();\n  const [bounds, setBounds] = React.useState(null);\n  const [map, setMap] = React.useState(null);\n\n  React.useEffect(() =\u003e {\n    if (map != null) {\n      const boundsChangedListener = map.addListener('bounds_changed', () =\u003e {\n        const bounds = map.getBounds();\n        setBounds(bounds);\n      });\n\n      return () =\u003e {\n        boundsChangedListener.remove();\n      };\n    }\n  }, [map]);\n\n  return (\n    \u003cdiv\u003e\n      \u003cInfo\u003e{bounds?.getCenter().toString() ?? ' '}\u003c/Info\u003e\n      \u003cRatio value={3 / 4}\u003e\n        {api \u0026\u0026 \u003cMap ref={setMap} api={api} options={MAP_OPTIONS} /\u003e}\n      \u003c/Ratio\u003e\n    \u003c/div\u003e\n  );\n}\n\n","pathname":"/events","markdown":" \u003c!-- {\"order\": 4} --\u003e\n\u003ch1\u003eEvents\u003c/h1\u003e\n\u003cp\u003eGet instance of \u003ca href=\"https://developers.google.com/maps/documentation/javascript/reference/map\"\u003egoogle.maps.Map\u003c/a\u003e\nclass using \u003cem\u003eref\u003c/em\u003e property or \u003cem\u003euseMap\u003c/em\u003e hook.\nThen subscribe on any \u003ca href=\"https://developers.google.com/maps/documentation/javascript/events\"\u003eevent\u003c/a\u003e\ninside \u003cem\u003euseEffect\u003c/em\u003e hook using \u003cem\u003eaddListener\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eDon't forget to unsubscribe in \u003cem\u003euseEffect\u003c/em\u003e cleanup.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSometimes google map fires events like \u003cem\u003eidle\u003c/em\u003e in a wrong order,\nusually wrapping callback into 2 rafs helps.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eDon't use code below in production, it's better to intercept bounds changes inside \u003cem\u003eidle\u003c/em\u003e event.\u003c/p\u003e\n\u003c/blockquote\u003e\n"},{"title":"Google map methods","order":5,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map } from 'rgm';\nimport { Flex, Box } from 'react-system';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n};\n\nconst getSize = elt =\u003e {\n  const rect = elt.getBoundingClientRect();\n  return {\n    width: rect.width,\n    height: rect.height,\n  };\n};\n\nexport default function Imperative() {\n  const api = useGoogleApiLoader();\n  const [map, setMap] = React.useState(null);\n  const getOptions = React.useCallback(\n    elt =\u003e\n      getSize(elt).width \u003c 500\n        ? { ...MAP_OPTIONS, disableDefaultUI: true }\n        : MAP_OPTIONS,\n    [],\n  );\n\n  return (\n    \u003cdiv\u003e\n      \u003cFlex p={3}\u003e\n        \u003cbutton\n          onClick={() =\u003e {\n            map?.panBy(\n              200 * (Math.random() - 0.5),\n              200 * (Math.random() - 0.5),\n            );\n          }}\n        \u003e\n          Move\n        \u003c/button\u003e\n        \u003cBox width={'16px'} /\u003e\n        \u003cbutton\n          onClick={() =\u003e {\n            map?.setOptions({\n              disableDefaultUI: true,\n            });\n          }}\n        \u003e\n          Disable ui\n        \u003c/button\u003e\n        \u003cBox width={'16px'} /\u003e\n        \u003cbutton\n          onClick={() =\u003e {\n            map?.setOptions({\n              disableDefaultUI: false,\n            });\n          }}\n        \u003e\n          Enable ui\n        \u003c/button\u003e\n      \u003c/Flex\u003e\n      \u003cRatio value={3 / 4}\u003e\n        {api \u0026\u0026 \u003cMap ref={setMap} api={api} options={getOptions}\u003e\u003c/Map\u003e}\n      \u003c/Ratio\u003e\n    \u003c/div\u003e\n  );\n}\n\n","pathname":"/imperative","markdown":" \u003c!-- {\"order\": 5} --\u003e\n\u003ch1\u003eGoogle map methods\u003c/h1\u003e\n\u003cp\u003eAs like as using \u003cem\u003euseMap\u003c/em\u003e at \u003cem\u003eMap\u003c/em\u003e children Components you can\nuse ref to map instance and apply any operation on\n\u003ca href=\"https://developers.google.com/maps/documentation/javascript/reference/map\"\u003egoogle map instance\u003c/a\u003e imperatively.\u003c/p\u003e\n\u003cp\u003eUsing \u003cem\u003eref\u003c/em\u003e and \u003cem\u003euseEffect\u003c/em\u003e you can make any property controllable if needed.\u003c/p\u003e\n"},{"title":"React markers","order":6,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map, Overlay, Marker } from 'rgm';\nimport { Flex, Box } from 'react-system';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio, Checkbox, Select } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n  // disable cmd-zoom and 2 fingers zoom I personally dislike it\n  gestureHandling: 'greedy',\n  clickableIcons: false,\n};\n\nexport default function MarkerPage() {\n  const api = useGoogleApiLoader();\n\n  const [debug, setDebug] = React.useState(true);\n  const [alignSelf, setAlignSelf] = React.useState('end');\n  const [justifySelf, setJustifySelf] = React.useState('center');\n\n  return (\n    \u003cdiv\u003e\n      \u003cFlex p={3} alignItems=\"baseline\"\u003e\n        \u003cCheckbox id=\"debug\" value={debug} onChange={setDebug}\u003e\n          Debug\n        \u003c/Checkbox\u003e\n        \u003cBox width={'8px'} /\u003e\n        \u003cSelect\n          value={alignSelf}\n          onChange={setAlignSelf}\n          options={['start', 'center', 'end']}\n        /\u003e\n        \u003cBox width={'8px'} /\u003e\n        \u003cSelect\n          value={justifySelf}\n          onChange={setJustifySelf}\n          options={['start', 'center', 'end']}\n        /\u003e\n      \u003c/Flex\u003e\n\n      \u003cRatio value={3 / 4}\u003e\n        {api \u0026\u0026 (\n          \u003cMap api={api} options={MAP_OPTIONS}\u003e\n            \u003cOverlay debug={debug}\u003e\n              \u003cMarker lat={MAP_OPTIONS.center.lat} lng={MAP_OPTIONS.center.lng}\u003e\n                \u003cMarkerBottom\n                  style={{\n                    alignSelf,\n                    justifySelf,\n                    // easier to use placeSelf\n                  }}\n                  size={48}\n                  color={'red'}\n                /\u003e\n              \u003c/Marker\u003e\n              \u003cMarker\n                lat={MAP_OPTIONS.center.lat + 0.1}\n                lng={MAP_OPTIONS.center.lng + 0.3}\n              \u003e\n                \u003cMarkerCentered\n                  style={{\n                    alignSelf,\n                    justifySelf,\n                  }}\n                  size={48}\n                  color={'Fuchsia'}\n                /\u003e\n              \u003c/Marker\u003e\n              \u003cMarker\n                lat={MAP_OPTIONS.center.lat - 0.1}\n                lng={MAP_OPTIONS.center.lng - 0.3}\n              \u003e\n                \u003cMarkerCorner\n                  style={{\n                    alignSelf,\n                    justifySelf,\n                  }}\n                  size={48}\n                  color={'OrangeRed'}\n                /\u003e\n              \u003c/Marker\u003e\n            \u003c/Overlay\u003e\n          \u003c/Map\u003e\n        )}\n      \u003c/Ratio\u003e\n    \u003c/div\u003e\n  );\n}\n\nconst MarkerBottom = ({ size, color, style }) =\u003e (\n  \u003csvg\n    style={style}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    height={size}\n    width={size}\n    viewBox=\"2 2 20 20\"\n    fill={color}\n  \u003e\n    \u003cpath d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" /\u003e\n    \u003cpath d=\"M0 0h24v24H0z\" fill=\"none\" /\u003e\n  \u003c/svg\u003e\n);\n\nconst MarkerCentered = ({ size, color, style }) =\u003e (\n  \u003csvg\n    style={style}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    height={size}\n    viewBox=\"0 0 24 24\"\n    width={size}\n    fill={color}\n  \u003e\n    \u003cpath d=\"M0 0h24v24H0z\" fill=\"none\" /\u003e\n    \u003cpath d=\"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z\" /\u003e\n  \u003c/svg\u003e\n);\n\nconst MarkerCorner = ({ size, color, style }) =\u003e (\n  \u003csvg\n    style={style}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    height={size}\n    viewBox=\"3 3 18 18\"\n    width={size}\n    fill={color}\n  \u003e\n    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\" /\u003e\n    \u003cpath d=\"M21 3L3 10.53v.98l6.84 2.65L12.48 21h.98L21 3z\" /\u003e\n  \u003c/svg\u003e\n);\n\n","pathname":"/react-markers","markdown":" \u003c!-- {\"order\": 6} --\u003e\n\u003ch1\u003eReact markers\u003c/h1\u003e\n\u003cp\u003eFast, rerendering of markers is not occured during move/zoom operation\n\u003cem\u003e(if you dont update state on bounds, etc change events, \u003ca href=\"/events\"\u003esee idle quote\u003c/a\u003e)\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eTo add custom React marker on map, you need 2 controls \u003cem\u003eOverlay\u003c/em\u003e and \u003cem\u003eMarker\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developers.google.com/maps/documentation/javascript/examples/overlay-simple\"\u003eOverlay\u003c/a\u003e\nis needed to place React components inside.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eMarker\u003c/em\u003e is a wrapper around your component\nto pass \u003cem\u003elat\u003c/em\u003e, \u003cem\u003elng\u003c/em\u003e into \u003cem\u003eOverlay\u003c/em\u003e in a type safe way wihout touching props of your component.\u003c/p\u003e\n\u003cp\u003eEach marker is rendered inside placeholder with \u003cem\u003e{ width:0; height:0; display: grid }\u003c/em\u003e style.\nThis allows to select origin point of marker using only its\nown css \u003cem\u003eplace-self\u003c/em\u003e, \u003cem\u003ealign-self\u003c/em\u003e, \u003cem\u003ejustify-self\u003c/em\u003e properties.\nAlso \u003cem\u003e{ position: absolute }\u003c/em\u003e on a holder allows everything if grid positioning is not enough.\u003c/p\u003e\n\u003cp\u003eTo simplify markers positioning you can use \u003cem\u003edebug\u003c/em\u003e propery of \u003cem\u003eOverlay\u003c/em\u003e element.\nIt will show exact origin point position.\u003c/p\u003e\n\u003cp\u003eSee below how to use \u003cem\u003eOverlay\u003c/em\u003e and \u003cem\u003eMarker\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eAlso play with \u003cem\u003edebug\u003c/em\u003e property to see how you can use\ncss \u003cem\u003ealignSelf\u003c/em\u003e , \u003cem\u003ejustifySelf\u003c/em\u003e, \u003cem\u003eplaceSelf\u003c/em\u003e properties to align different kind of markers.\n\u003cem\u003e(For markers with \u0026quot;fun\u0026quot; shape use \u003cem\u003eposition:relative\u003c/em\u003e and css left, right properties)\u003c/em\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cem\u003edebug\u003c/em\u003e property won't work in production builds.\u003c/p\u003e\n\u003c/blockquote\u003e\n"},{"title":"Clusters example","order":7,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map, Overlay, Marker } from 'rgm';\nimport { css } from '@emotion/core';\n// $FlowFixMe\nimport Supercluster from 'supercluster';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio } from '../dev-src/controls';\nimport { getScreenOffset } from '../dev-src/geo-utils';\n// $FlowFixMe\nimport places from '../data/places.json';\n\nconst superclusterIndex = new Supercluster({\n  log: false,\n  radius: 60,\n  extent: 256,\n  maxZoom: 17,\n}).load(places.features);\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 1,\n  maxZoom: 17,\n  center: {\n    lat: 0,\n    lng: 30.304,\n  },\n  // disable cmd-zoom and 2 fingers zoom I personally dislike it\n  gestureHandling: 'greedy',\n  clickableIcons: false,\n};\n\ntype Cluster = {|\n  geometry: {|\n    coordinates: [number, number],\n  |},\n  id?: number,\n  properties: {|\n    cluster?: boolean,\n    cluster_id?: number,\n    point_count?: number,\n  |},\n|};\n\n// Google has no \"zoom at point\" method\nconst zoomAt = (map, pt, zoom) =\u003e {\n  const center = map.getCenter();\n  const centerLatLng = {\n    lat: center.lat(),\n    lng: center.lng(),\n  };\n  const offsetA = getScreenOffset(pt, centerLatLng, map.getZoom());\n  const offsetB = getScreenOffset(pt, centerLatLng, zoom);\n  const x = offsetA.x - offsetB.x;\n  const y = offsetA.y - offsetB.y;\n  map.setZoom(zoom);\n  map.panBy(x, y);\n};\n\nexport default function Clusters() {\n  const api = useGoogleApiLoader();\n  const [map, setMap] = React.useState(null);\n  const [clusters, setClusters] = React.useState\u003c$ReadOnlyArray\u003cCluster\u003e\u003e([]);\n\n  React.useEffect(() =\u003e {\n    if (map != null) {\n      const boundsChangedListener = map.addListener('idle', () =\u003e {\n        const bounds = map.getBounds();\n        const zoom = map.getZoom();\n        const sw = bounds.getSouthWest();\n        const ne = bounds.getNorthEast();\n\n        const swA = [sw.lng(), sw.lat()];\n        const neA = [ne.lng(), ne.lat()];\n        // Supercluster don't work in some cases, fix it\n        if (swA[0] \u003e neA[0] \u0026\u0026 swA[0] - neA[0] \u003c 0.00001) {\n          swA[0] = -180;\n          neA[0] = 180;\n        }\n\n        const clusters = superclusterIndex.getClusters([...swA, ...neA], zoom);\n\n        setClusters(clusters);\n      });\n\n      return () =\u003e {\n        boundsChangedListener.remove();\n      };\n    }\n  }, [map]);\n\n  return (\n    \u003cRatio value={3 / 4}\u003e\n      {api \u0026\u0026 (\n        \u003cMap ref={setMap} api={api} options={MAP_OPTIONS}\u003e\n          \u003cOverlay debug={false}\u003e\n            {clusters.map(cluster =\u003e {\n              const [lng, lat] = cluster.geometry.coordinates;\n              return (\n                \u003cMarker key={`${lng} - ${lat}`} lng={lng} lat={lat}\u003e\n                  \u003cClusterMarker\n                    count={cluster.properties.point_count ?? null}\n                    onClick={() =\u003e {\n                      if (map \u0026\u0026 cluster.id != null) {\n                        zoomAt(\n                          map,\n                          {\n                            lng,\n                            lat,\n                          },\n                          superclusterIndex.getClusterExpansionZoom(cluster.id),\n                        );\n                      }\n                    }}\n                  /\u003e\n                \u003c/Marker\u003e\n              );\n            })}\n          \u003c/Overlay\u003e\n        \u003c/Map\u003e\n      )}\n    \u003c/Ratio\u003e\n  );\n}\n\n// css is awesome!\nconst ClusterMarker = ({ count, onClick }) =\u003e {\n  const text = count ?? '';\n\n  return (\n    \u003cdiv\n      onClick={onClick}\n      css={css`\n        position: relative;\n        place-self: center center;\n        border-radius: 100%;\n        border: 3px solid #eee;\n        background-color: white;\n        padding: ${count == null ? 2 : 8}px;\n        box-shadow: 0 0 0 2px #fe4a0d, 0 0 0 4px white;\n        \u0026:after {\n          padding-top: 100%;\n          content: ' ';\n          display: block;\n        }\n        font-size: 1rem;\n\n        \u0026:hover {\n          padding: ${count == null ? 3 : 10}px;\n          transition: padding 0.07s ease-out;\n          z-index: 1;\n        }\n        transition: padding 0.07s ease-in;\n        cursor: pointer;\n      `}\n    \u003e\n      \u003cdiv\n        css={css`\n          height: 0;\n          overflow: hidden;\n        `}\n      \u003e\n        {text}\n      \u003c/div\u003e\n      \u003cdiv\n        css={css`\n          position: absolute;\n          left: 0;\n          top: 0;\n          width: 100%;\n          height: 100%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        `}\n      \u003e\n        {text}\n      \u003c/div\u003e\n    \u003c/div\u003e\n  );\n};\n\n","pathname":"/clusters","markdown":" \u003c!-- {\"order\": 7} --\u003e\n\u003ch1\u003eClusters example\u003c/h1\u003e\n\u003cp\u003eReal life example. \u003cem\u003e(clusters, zoom on marker click)\u003c/em\u003e\u003c/p\u003e\n"},{"title":"N markers","order":8,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map, Overlay, Marker } from 'rgm';\nimport { css } from '@emotion/core';\nimport { Flex, Box } from 'react-system';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio, Select } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n  gestureHandling: 'greedy',\n  clickableIcons: false,\n};\n\nconst genRandomMarkers = n =\u003e\n  Array.from(Array(n), () =\u003e {\n    const r = Math.random() * 2 + 0.05;\n    const angle = Math.random() * 2 * Math.PI;\n\n    return {\n      lat: MAP_OPTIONS.center.lat + r * Math.cos(angle),\n      lng: MAP_OPTIONS.center.lng + r * Math.sin(angle),\n    };\n  });\n\nexport default function Performance() {\n  const api = useGoogleApiLoader();\n  const INITIAL_MARKERS_COUNT = 200;\n  const [markers, setMarkers] = React.useState(() =\u003e\n    genRandomMarkers(INITIAL_MARKERS_COUNT),\n  );\n\n  return (\n    \u003cdiv\u003e\n      \u003cFlex p={3}\u003e\n        \u003cBox pr={2}\u003eCount:\u003c/Box\u003e\n        \u003cSelect\n          options={['100', '200', '300', '500', '1000', '2000']}\n          value={`${markers.length}`}\n          onChange={v =\u003e {\n            setMarkers(genRandomMarkers(Number.parseFloat(v)));\n          }}\n        /\u003e\n      \u003c/Flex\u003e\n      \u003cRatio value={3 / 4}\u003e\n        {api \u0026\u0026 (\n          \u003cMap api={api} options={MAP_OPTIONS}\u003e\n            \u003cOverlay\u003e\n              {markers.map((m, index) =\u003e (\n                \u003cMarker key={index} lat={m.lat} lng={m.lng}\u003e\n                  \u003cCircleMarker /\u003e\n                \u003c/Marker\u003e\n              ))}\n            \u003c/Overlay\u003e\n          \u003c/Map\u003e\n        )}\n      \u003c/Ratio\u003e\n    \u003c/div\u003e\n  );\n}\n\nconst CircleMarker = () =\u003e (\n  \u003cdiv\n    css={css`\n      place-self: center center;\n      width: 10px;\n      height: 10px;\n      border-radius: 100%;\n      background-color: white;\n      border: 2px solid red;\n    `}\n  /\u003e\n);\n\n","pathname":"/performance","markdown":" \u003c!-- {\"order\": 8 } --\u003e\n\u003ch1\u003eN markers\u003c/h1\u003e\n\u003cp\u003eExample of drawing N React markers.\u003c/p\u003e\n"},{"title":"Typescript","order":10,"source":"\n\nimport * as React from 'react';\nimport { Map, Overlay, Marker, useMap } from 'rgm';\nimport { css } from '@emotion/core';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS: google.maps.MapOptions = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n  gestureHandling: 'greedy',\n  clickableIcons: false,\n};\n\nconst Child = () =\u003e {\n  const { api, map } = useMap();\n\n  React.useEffect(() =\u003e {\n    console.log(map.getCenter().toJSON(), api.version);\n  }, [map]);\n\n  return null;\n};\n\nexport default function TsRgm() {\n  const api = useGoogleApiLoader();\n  const [map, setMap] = React.useState\u003cnull | google.maps.Map\u003cHTMLDivElement\u003e\u003e(\n    null,\n  );\n\n  return (\n    \u003cdiv\u003e\n      \u003cbutton\n        css={css`\n          margin: 16px;\n        `}\n        onClick={() =\u003e {\n          if (map != null) {\n            map.panBy(Math.random() * 300 - 150, Math.random() * 300 - 150);\n          }\n        }}\n      \u003e\n        Click\n      \u003c/button\u003e\n      \u003cRatio value={3 / 4}\u003e\n        {api \u0026\u0026 (\n          \u003cMap ref={setMap} api={api} options={MAP_OPTIONS}\u003e\n            \u003cOverlay\u003e\n              \u003cMarker lat={59.936} lng={30.314}\u003e\n                \u003cCircleMarker /\u003e\n              \u003c/Marker\u003e\n            \u003c/Overlay\u003e\n            \u003cChild /\u003e\n          \u003c/Map\u003e\n        )}\n      \u003c/Ratio\u003e\n    \u003c/div\u003e\n  );\n}\n\nconst CircleMarker = () =\u003e (\n  \u003cdiv\n    css={css`\n      place-self: center center;\n      width: 50px;\n      height: 50px;\n      border-radius: 100%;\n      background-color: white;\n      border: 3px solid red;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    `}\n  \u003e\n    TS\n  \u003c/div\u003e\n);\n\n","pathname":"/ts-example","markdown":" \u003c!-- {\"order\": 10} --\u003e\n\u003ch1\u003eTypescript\u003c/h1\u003e\n\u003cp\u003eTS usage example.\u003c/p\u003e\n\u003cp\u003eMinimal example with all existing api usage \u003cem\u003e(without Overlay debug prop)\u003c/em\u003e.\u003c/p\u003e\n"},{"title":"N markers (uniq key)","order":100,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map, Overlay, Marker } from 'rgm';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n  gestureHandling: 'greedy',\n  clickableIcons: false,\n};\n\nlet uniq = 1;\n\nconst genRandomMarkers = n =\u003e\n  Array.from(Array(n), () =\u003e ({\n    key: uniq++,\n    lat: MAP_OPTIONS.center.lat + (Math.random() - 0.5) * 2 * 0.6,\n    lng: MAP_OPTIONS.center.lng + (Math.random() - 0.5) * 2 * 0.6,\n  }));\n\nexport default function TestUniq() {\n  const api = useGoogleApiLoader();\n  const INITIAL_MARKERS_COUNT = 200;\n  const [markers, setMarkers] = React.useState(\n    genRandomMarkers(INITIAL_MARKERS_COUNT),\n  );\n\n  React.useEffect(() =\u003e {\n    const startTime = new Date();\n    const MARKERS_TO_DELETE = 10;\n    const INTERVAL_TIMEOUT = 100;\n\n    let newCount = MARKERS_TO_DELETE;\n\n    const handle = setInterval(() =\u003e {\n      setMarkers(markers =\u003e {\n        const dt = (new Date() - startTime) / 1000;\n        if (dt \u003e 30) {\n          newCount = 9;\n        }\n        if (dt \u003e 60) {\n          newCount = 0;\n        }\n\n        const oldMarkers = [...markers];\n\n        // Drop random interval\n        oldMarkers.splice(\n          Math.max(\n            0,\n            Math.floor(Math.random() * oldMarkers.length) - MARKERS_TO_DELETE,\n          ),\n          MARKERS_TO_DELETE,\n        );\n\n        const newMarkers = genRandomMarkers(newCount);\n        const r = [...oldMarkers, ...newMarkers];\n        return r;\n      });\n    }, INTERVAL_TIMEOUT);\n\n    return () =\u003e {\n      clearInterval(handle);\n    };\n  }, []);\n\n  return (\n    \u003cRatio value={3 / 4}\u003e\n      {api \u0026\u0026 (\n        \u003cMap api={api} options={MAP_OPTIONS}\u003e\n          \u003cOverlay\u003e\n            {markers.map(m =\u003e (\n              \u003cMarker key={m.key} lat={m.lat} lng={m.lng}\u003e\n                \u003cSvgMarker\n                  style={{\n                    alignSelf: 'end',\n                    justifySelf: 'center',\n                    // easier to use placeSelf\n                  }}\n                  size={18}\n                  color={'red'}\n                /\u003e\n              \u003c/Marker\u003e\n            ))}\n          \u003c/Overlay\u003e\n        \u003c/Map\u003e\n      )}\n    \u003c/Ratio\u003e\n  );\n}\n\nconst SvgMarker = ({ size, color, style }) =\u003e (\n  \u003csvg\n    style={style}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    height={size}\n    width={size}\n    viewBox=\"2 2 20 20\"\n    fill={color}\n  \u003e\n    \u003cpath d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" /\u003e\n    \u003cpath d=\"M0 0h24v24H0z\" fill=\"none\" /\u003e\n  \u003c/svg\u003e\n);\n\n","pathname":"/vis-test-n-uniq","markdown":" \u003c!-- {\"order\": 100 } --\u003e\n\u003ch1\u003eN markers (uniq key)\u003c/h1\u003e\n\u003cp\u003eMost tests here are visual tests\u003c/p\u003e\n\u003ch3\u003eWhat to do\u003c/h3\u003e\n\u003cp\u003eYou need to actively move/zoom map until markers exists.\u003c/p\u003e\n\u003ch3\u003eWhat to expect\u003c/h3\u003e\n\u003cp\u003eAll markers are moving to predictable direction. No markers should stay at the end\u003c/p\u003e\n"},{"title":"N markers (key as index)","order":101,"source":"// @flow\n\nimport * as React from 'react';\nimport { Map, Overlay, Marker } from 'rgm';\nimport { useGoogleApiLoader } from '../dev-src/hooks';\nimport { Ratio } from '../dev-src/controls';\n\n// https://developers.google.com/maps/documentation/javascript/reference/map#MapOptions\nconst MAP_OPTIONS = {\n  zoom: 9,\n  center: {\n    lat: 59.936,\n    lng: 30.314,\n  },\n  gestureHandling: 'greedy',\n  clickableIcons: false,\n};\n\nconst genRandomMarkers = n =\u003e\n  Array.from(Array(n), () =\u003e ({\n    lat: MAP_OPTIONS.center.lat + (Math.random() - 0.5) * 2 * 0.6,\n    lng: MAP_OPTIONS.center.lng + (Math.random() - 0.5) * 2 * 0.6,\n  }));\n\nexport default function TestIndex() {\n  const api = useGoogleApiLoader();\n  const INITIAL_MARKERS_COUNT = 200;\n  const [markers, setMarkers] = React.useState(\n    genRandomMarkers(INITIAL_MARKERS_COUNT),\n  );\n\n  React.useEffect(() =\u003e {\n    const startTime = new Date();\n    const MARKERS_TO_DELETE = 10;\n    const INTERVAL_TIMEOUT = 100;\n\n    let newCount = MARKERS_TO_DELETE;\n\n    const handle = setInterval(() =\u003e {\n      setMarkers(markers =\u003e {\n        const dt = (new Date() - startTime) / 1000;\n        if (dt \u003e 30) {\n          newCount = 9;\n        }\n        if (dt \u003e 60) {\n          newCount = 0;\n        }\n\n        const oldMarkers = [...markers];\n\n        // Drop random interval\n        oldMarkers.splice(\n          Math.max(\n            0,\n            Math.floor(Math.random() * oldMarkers.length) - MARKERS_TO_DELETE,\n          ),\n          MARKERS_TO_DELETE,\n        );\n\n        const newMarkers = genRandomMarkers(newCount);\n        const r = [...oldMarkers, ...newMarkers];\n        return r;\n      });\n    }, INTERVAL_TIMEOUT);\n\n    return () =\u003e {\n      clearInterval(handle);\n    };\n  }, []);\n\n  return (\n    \u003cRatio value={3 / 4}\u003e\n      {api \u0026\u0026 (\n        \u003cMap api={api} options={MAP_OPTIONS}\u003e\n          \u003cOverlay\u003e\n            {markers.map((m, index) =\u003e (\n              \u003cMarker key={index} lat={m.lat} lng={m.lng}\u003e\n                \u003cSvgMarker\n                  style={{\n                    alignSelf: 'end',\n                    justifySelf: 'center',\n                    // easier to use placeSelf\n                  }}\n                  size={18}\n                  color={'red'}\n                /\u003e\n              \u003c/Marker\u003e\n            ))}\n          \u003c/Overlay\u003e\n        \u003c/Map\u003e\n      )}\n    \u003c/Ratio\u003e\n  );\n}\n\nconst SvgMarker = ({ size, color, style }) =\u003e (\n  \u003csvg\n    style={style}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    height={size}\n    width={size}\n    viewBox=\"2 2 20 20\"\n    fill={color}\n  \u003e\n    \u003cpath d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" /\u003e\n    \u003cpath d=\"M0 0h24v24H0z\" fill=\"none\" /\u003e\n  \u003c/svg\u003e\n);\n\n","pathname":"/vis-test-n-index","markdown":" \u003c!-- {\"order\": 101 } --\u003e\n\u003ch1\u003eN markers (key as index)\u003c/h1\u003e\n\u003cp\u003eMost tests here are visual tests\u003c/p\u003e\n\u003ch3\u003eWhat to do\u003c/h3\u003e\n\u003cp\u003eYou need to actively move/zoom map until markers exists.\u003c/p\u003e\n\u003ch3\u003eWhat to expect\u003c/h3\u003e\n\u003cp\u003eAll markers are moving to predictable direction. No markers should stay at the end\u003c/p\u003e\n"}]},"__N_SSG":true},"page":"/clusters","query":{},"buildId":"0ltODh2t6la7EpPzfTwqQ","assetPrefix":"/rgm","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/rgm/_next/static/runtime/polyfills-531e5b976e9a4328bb69.js"></script><script async="" data-next-page="/_app" src="/rgm/_next/static/0ltODh2t6la7EpPzfTwqQ/pages/_app.js"></script><script async="" data-next-page="/clusters" src="/rgm/_next/static/0ltODh2t6la7EpPzfTwqQ/pages/clusters.js"></script><script src="/rgm/_next/static/runtime/webpack-1c5199ff66550d26e499.js" async=""></script><script src="/rgm/_next/static/chunks/framework.e84fa698c7ee940652bd.js" async=""></script><script src="/rgm/_next/static/chunks/13cbfce1.9c3965372dce5ef7c77e.js" async=""></script><script src="/rgm/_next/static/chunks/commons.51a222874f57d1c3e4a9.js" async=""></script><script src="/rgm/_next/static/chunks/c1a69c9d71809a24512853133d6615d88c848ee2.f486bf62241ddac94c93.js" async=""></script><script src="/rgm/_next/static/runtime/main-930559fd51454aac4b45.js" async=""></script><script src="/rgm/_next/static/0ltODh2t6la7EpPzfTwqQ/_buildManifest.js" async=""></script><script src="/rgm/_next/static/0ltODh2t6la7EpPzfTwqQ/_ssgManifest.js" async=""></script></body></html>